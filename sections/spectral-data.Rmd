
## Spectral Data

Do we have any MIR spectra associated with Clarksville? Nope, not even for siblings of the same subgroup. We have some for more recently sampled pedons. Maybe we can use CECIL or something like that.

Jay suggested looking at soils in Paleudults. Here is a sample dataset that loads 16 pedons in "Typic Paleudults" w/ MIR spectra using `soilDB::fetchLDM()` (development branch) and a local SQLite DB. Added the sample data _typic_paleudults-mir-SPC.rda_ to local-data.

```{r echo = FALSE}
library(aqp)
library(soilDB)
# # use remotes::install_github("ncss-tech/soilDB@fetchLDM") and SQLite KSSL db with MIR data
# res <- try(fetchLDM("Typic Paleudults",
#                     dsn  = "E:/Geodata/soils/ncss_labdatasqlite/ncss_labdata.sqlite",
#                     what = 'samp_taxsubgrp',
#                     tables = c("lab_chemical_properties","lab_mir")))
# 
# # first profile with MIR data
# res1 <- subset(res, !is.na(res$smp_id))
# res2 <- subset(res1, res$samp_name == "Pikeville")[1,]
# ressub <- subsetHz(res2, as.logical(diff(c(0, factor(res2$labsampnum)))))
# 
# checkHzDepthLogic(ressub)
# 
# saveRDS(ressub, file = "../local-data/typic_paleudults-mir-SPC.rds")
ressub <- readRDS("../local-data/typic_paleudults-mir-SPC.rds")

# lots of MIR runs per labsampnum
ressub$id
table(ressub$labsampnum)

# first rep, first horizon base plot
abs <- strsplit(ressub[1, 1]$absorbance, ",")[[1]]
wav <- strsplit(ressub[1, 1]$wavelength_string, ",")[[1]]
plot(abs ~ wav,
     main = paste("First replicate of each MIR scanned horizon", ressub[1,1]$pedlabsampnum),
     xlab = "Wavelength (nm)",
     ylab = "Absorbance (-)",
     ylim = c(0, 2),
     type = "l")

# first rep, second horizon add line
abs <- strsplit(ressub[1, 2]$absorbance, ",")[[1]]
wav <- strsplit(ressub[1, 2]$wavelength_string, ",")[[1]]
lines(abs ~ wav, col = "blue")

# first rep, third horizon add line
abs <- strsplit(ressub[1, 3]$absorbance, ",")[[1]]
wav <- strsplit(ressub[1, 3]$wavelength_string, ",")[[1]]
lines(abs ~ wav, col = "red")

# first rep, fourth horizon add line
abs <- strsplit(ressub[1, 4]$absorbance, ",")[[1]]
wav <- strsplit(ressub[1, 4]$wavelength_string, ",")[[1]]
lines(abs ~ wav, col = "green")
legend(
  "topright",
  legend = paste(c(ressub[1,]$hzn_top[c(1:4)]), "cm"),
  lty = c(1, 1, 1, 1),
  col = c("black", "blue", "red", "green")
)
```





